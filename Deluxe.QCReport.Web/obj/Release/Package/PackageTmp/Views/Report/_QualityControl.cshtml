@model Deluxe.QCReport.Common.Models.ReportVM

<table width="100%" border="0" cellspacing="0" cellpadding="1">
    <tr>
        <td width="180"><img src="../images/Logos/End-Cred-Red-Logo_tran-100x100.png" border="0"></td>
        <td align="center">
            <h2 class="txt_boldtype2">
                QUALITY CONTROL REPORT FOR<br>
                @Model.Header_VM.CustName
            </h2>
        </td>
        <td align="right">
            Page: 1 of <span id="totalPage1"></span>
        </td>
    </tr>
    <tr>
        <td colspan="3" align="center"><b>@Model.Address</b>&nbsp;</td>
    </tr>
</table>

<table width="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000" height="36">
    <tr>
        <td>
            <table width="100%" border="0" cellspacing="0" cellpadding="1">
                <tr>
                    <td>Title: <b>@Model.Header_VM.Show</b></td>
                    <td>Part#: <b>Part @Model.Header_VM.This_part of @Model.Header_VM.Tot_Part</b></td>
                    <td>QC#: <b>@Model.Qcnum</b></td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>Episode: <b>@Model.Header_VM.Epis_name</b></td>
                    <td>Episode#: <b>@Model.Header_VM.Epis_no</b></td>
                    <td>WO#: <b>@Model.WONum</b></td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>

                    @if (Model.Header_VM.AssetType.ToLower() == "tape")
                    {
                        <td>Subtitle: <b>@Model.Header_VM.Subtitle</b></td>
                    }

                    <td>Language: <b>@Model.Header_VM.HLanguage</b></td>
                    <td>PO#: <b>@Model.Header_VM.Pono</b></td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>Version: <b>@Model.Header_VM.Version</b></td>
                    <td>TRT: <b>@Model.Header_VM.TRT</b></td>

                    @if (Model.Header_VM.AssetType.ToLower() == "tape")
                    {
                        <td>Tape #: <b>@Model.Header_VM.TapeNumber</b></td>
                    }

                </tr>

                @if (Model.Header_VM.AssetType.ToLower() == "file")
                {

                    <tr><td colspan='3'>&nbsp;</td></tr>
                    <tr><td colspan='3'>Filename: <b>@Model.Header_VM.Filename</b></td></tr>
                }

                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>Status: <font size=3><b>@Model.Final_VM.EvalStatus</b></font></td>
                    <td>Head Logo: <b>@Model.Header_VM.HeadLogo</b></td>
                    <td>Tail Logo: <b>@Model.Header_VM.TailLogo</b></td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>Video Grade: <b>@Model.Final_VM.GradeVideo</b></td>
                    <td>Audio Grade: <b>@Model.Final_VM.GradeAudio</b></td>
                    <td>Overall Grade: <b>@Model.Final_VM.GradeOverall</b></td>
                </tr>

            </table>
        </td>
    </tr>
</table>


<table width="100%" border="0" cellspacing="0" cellpadding="1">
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table width="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000">
    <tr>
        <td>
            @if (Model.Header_VM.AssetType.ToLower() == "tape")
            {
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td width="25%">Format: <b>@Model.Header_VM.Format</b></td>
                        <td width="25%">Standard: <b>@Model.Header_VM.Standard</b></td>
                        <td width="25%">Aspect Ratio: <b>@Model.Header_VM.Aspect</b></td>
                        <td width="25%"> </td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Description: <b>@Model.Header_VM.TapeDesc1</b></td>
                        <td width="25%">&nbsp;</td>
                        <td width="25%">Time Code: <b>@Model.AudioTC_VM.TimeCode</b></td>
                        <td width="25%">&nbsp;</td>
                    </tr>
                </table>
            }
            else
            {
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td width="25%">Format: <b>@Model.Header_VM.Format</b></td>
                        <td width="25%">Standard: <b>@Model.Header_VM.Standard</b></td>
                        <td width="25%">Aspect Ratio: <b>@Model.Header_VM.Aspect</b></td>
                        <td width="25%">&nbsp; </td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Description: <b>@Model.Header_VM.TapeDesc1</b></td>
                        <td width="25%">&nbsp;</td>
                        <td width="25%">Time Code: <b>@Model.AudioTC_VM.TimeCode</b></td>
                        <td width="25%">Frame Size: <b>@Model.OverallSpecs_VM.FrameSize</b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Video Codec: <b>@Model.OverallSpecs_VM.VideoCodec</b></td>
                        <td width="25%">Video Bit Rate: <b>@Model.OverallSpecs_VM.VideoBitRate</b></td>
                        <td width="25%">Video Bit Depth: <b>@Model.OverallSpecs_VM.VideoBitDepth</b></td>
                        <td width="25%">Bit Rate Mode: <b>@Model.OverallSpecs_VM.BitRateMode</b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Audio Codec: <b>@Model.OverallSpecs_VM.AudioCodec</b></td>
                        <td width="25%">Audio Bit Rate: <b>@Model.OverallSpecs_VM.AudioBitRate</b></td>
                        <td width="25%">Audio Bit Depth: <b>@Model.OverallSpecs_VM.AudioBitDepth</b></td>
                        <td width="25%">Sample Rate: <b>@Model.OverallSpecs_VM.SampleRate</b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">GOP Structure: <b>@Model.OverallSpecs_VM.GOPStructure</b></td>
                        <td width="25%">Gamut: <b>@Model.OverallSpecs_VM.Gamut</b></td>
                        <td width="25%">Colour Encoding: <b>@Model.OverallSpecs_VM.ColourEncoding</b></td>
                        <td width="25%">File Size: <b>@Model.OverallSpecs_VM.Filesize</b></td>
                    </tr>

                </table>
            }
        </td>
            </tr>
        </table>


<table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<table width="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000" height="90">
    <tr>
        <td valign="top">
            <table width="100%" border="0" cellspacing="0" cellpadding="1">
                <tr>
                    <td>QC Date: <b>@Model.Header_VM.QC_date.Value.ToString("dd/MM/yyyy hh:mm:ss")</b></td>
                    <td>QC Operator: <b>@Model.History_VM.FullName</b></td>
                    <td>QC VTR: <b>@Model.History_VM.QC_VTR</b></td>
                    <td>Control Room #: <b>@Model.History_VM.Bay_Num</b></td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>
                        Record Date:&nbsp; <b>
                        @if(Model.History_VM.Rec_Date.HasValue)
                        {
                            @Model.History_VM.Rec_Date.Value.ToString("dd/MM/yyyy");
                        }
                            
                        </b>
                    </td>
                    <td>
                        @if (Model.Header_VM.AssetType.ToLower() == "tape")
                        {
                            @Html.Raw(string.Format("Record VTR: <b> {0} </b>", Model.History_VM.Rec_VTR));
                        }
                        
                    </td>
                    <td>Record Facility: <b>@Model.History_VM.Rec_Fac</b></td>
                    <td>
                        Textless at Tail: <b>
                            @if (Model.History_VM.textless == "Y") { @Html.Raw("Yes"); } else { @Html.Raw("No"); }

                        </b>
                    </td>

                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>Text Duration: <b>@Model.History_VM.Duration</b></td>
                    <td>
                        @if (Model.Header_VM.AssetType.ToLower() == "tape")
                        {
                            @Html.Raw(string.Format("Stock Mfg: <b> {0} </b>", Model.History_VM.Stock_Mfg));
                        }

                    </td>
                    <td>
                        @if (Model.Header_VM.AssetType.ToLower() == "tape")
                        {
                            @Html.Raw(string.Format("Stock Batch #: <b> {0} </b>", Model.History_VM.Stock_Batch));
                        }

                    </td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>Source Standard: <b>@Model.History_VM.Src_Standard</b></td>
                    <td>Source Format: <b>@Model.History_VM.Src_Format</b></td>
                    <td>Source Desc: <b>@Model.History_VM.Src_Desc</b></td>
                    <td>&nbsp;</td>
                </tr>
                <tr>
                    <td colspan="4">&nbsp;</td>
                </tr>
                <tr>
                    <td>Additional Info: <b>@Model.History_VM.AddInfo</b></td>
                    <td>&nbsp;</td>
                    <td>Revised Date: <b>@Model.History_VM.Revised_Date</b></td>
                    <td>Revised By: <b>@Model.History_VM.Revised_By</b></td>
                </tr>
            </table>
        </td>
    </tr>
</table>


<table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

@if (Model.Header_VM.AssetType.ToLower() == "tape")
{

    Html.RenderPartial("_TapeAudioSpecifications", Model);

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>

    Html.RenderPartial("_VideoSpecifications", Model);

}

else
{

    Html.RenderPartial("_FileAudioSpecifications", Model);


    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>

    <div style="width:100%;">
        <div style="width:49%;float:left;">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
					<tr>
                        <td valign=" top" width="100%" height="100%">
                            @{Html.RenderPartial("_VideoSpecifications", Model);}
                        </td>
            </tr>
            </table>

            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td>&nbsp;</td>
                </tr>
            </table>

            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td width="100%">
                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td class="blackSquare" align="center"><b><i>SAFE AREA CHECK</i></b></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr>
                    <td>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td class="left_right_bottom_border">&nbsp;</td>
                                <td class="bottom_border"><b>&nbsp;All Display Formats</b></td>
                                <td class="left_right_bottom_border"><b>&nbsp;16:9 (when aspect ratio converted to 4:3)</b>
                            </tr>
                            <tr>
                                <td class="left_right_bottom_border"><b>&nbsp;Opening Titles:&nbsp;</b></td>
                                <td class="bottom_border">&nbsp; @Model.Final_VM.OTPercent Safe:&nbsp;</td>
                                <td class="left_right_bottom_border">&nbsp;Safe for:&nbsp; @Model.Final_VM.OTVersion </td>
                            </tr>
                            <tr>
                                <td class="left_right_bottom_border"><b>&nbsp;Closing Titles:&nbsp;</b></td>
                                <td class="bottom_border">&nbsp; @Model.Final_VM.CTPercent Safe:&nbsp;</td>
                                <td class="left_right_bottom_border">&nbsp;Safe for:&nbsp; @Model.Final_VM.CTVersion </td>
                            </tr>
                            <tr>
                                <td class="left_right_bottom_border"><b>&nbsp;Captions:&nbsp;</b></td>
                                <td class="bottom_border">&nbsp; @Model.Final_VM.CapPercent Safe:&nbsp;</td>
                                <td class="left_right_bottom_border">&nbsp;Safe for:&nbsp; @Model.Final_VM.CapVersion </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td>&nbsp;</td>
                </tr>
            </table>

            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td width="100%">
                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td class="blackSquare" align="center"><b><i>SUITABILITY</i></b></td>
                            </tr>
                        </table>
                    </td>
                </tr>

                <tr>
                    <td valign="top">
                        <table width="100%" border="0" cellspacing="0" cellpadding="0">
                            <tr>
                                <td class="left_bottom_border">&nbsp;</td>
                                <td class="left_bottom_border"><b>&nbsp;Y / N <br></b></td>
                                <td class="left_right_bottom_border"><b>&nbsp;Reason</b></td>
                            </tr>
                            <tr>
                                <td class="left_bottom_border"><b>&nbsp;Broadcast:&nbsp;</b></td>
                                <td class="left_bottom_border">&nbsp; @Model.Final_VM.BroadcastSuitable </td>
                                <td class="left_right_bottom_border">&nbsp; @Model.Final_VM.BroadcastSuitableReason </td>
                            </tr>
                            <tr>
                                <td class="left_bottom_border"><b>&nbsp;DVD / Blu-Ray:&nbsp;</b></td>
                                <td class="left_bottom_border">&nbsp; @Model.Final_VM.DVDBluRaySuitable </td>
                                <td class="left_right_bottom_border">&nbsp; @Model.Final_VM.DVDBluRaySuitableReason </td>
                            </tr>
                            <tr>
                                <td class="left_bottom_border"><b>&nbsp;VOD:&nbsp;</b></td>
                                <td class="left_bottom_border">&nbsp; @Model.Final_VM.VODSuitable </td>
                                <td class="left_right_bottom_border">&nbsp; @Model.Final_VM.VODSuitableReason </td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>

        </div>

        <div style="width:49%;float:right;">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td valign="top" width="100%" class="blacksquare">
                        @{Html.RenderPartial("_ProgramFormat", Model.TapeLayout_VM);}
                    </td>
                </tr>
            </table>
        </div>

    </div>
}

@*

<table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<% If sAssetType = "Tape" Then %>

<table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td width="49.5%">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td class="blackSquare" align="center"><b><i>SAFE AREA CHECK</i></b></td>
                </tr>
            </table>
        </td>
        <td width="1%">&nbsp;</td>
        <td width="49.5%">
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td class="blackSquare" align="center"><b><i>SUITABILITY</i></b></td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>
            <table width="100%" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td class="left_right_bottom_border">&nbsp;</td>
                    <td class="bottom_border"><b>&nbsp;All Display Formats</b></td>
                    <td class="left_right_bottom_border"><b>&nbsp;16:9 (when aspect ratio converted to 4:3)</b>
                </tr>
                <tr>
                    <td class="left_right_bottom_border"><b>&nbsp;Opening Titles:&nbsp;</b></td>
                    <td class="bottom_border">&nbsp;<%=rsHeader.Fields("OTPercent")%> Safe:&nbsp;</td>
                    <td class="left_right_bottom_border">&nbsp;Safe for:&nbsp; <%=rsHeader.Fields("OTVer")%></td>
                </tr>
                <tr>
                    <td class="left_right_bottom_border"><b>&nbsp;Closing Titles:&nbsp;</b></td>
                    <td class="bottom_border">&nbsp;<%=rsHeader.Fields("CTPercent")%> Safe:&nbsp;</td>
                    <td class="left_right_bottom_border">&nbsp;Safe for:&nbsp; <%=rsHeader.Fields("CTVer")%></td>
                </tr>
                <tr>
                    <td class="left_right_bottom_border"><b>&nbsp;Captions:&nbsp;</b></td>
                    <td class="bottom_border">&nbsp;<%=rsHeader.Fields("CapPercent")%> Safe:&nbsp;</td>
                    <td class="left_right_bottom_border">&nbsp;Safe for:&nbsp; <%=rsHeader.Fields("CapVer")%>&nbsp;</td>
                </tr>
            </table>
        </td>
        <td>&nbsp;</td>
        <td valign="top" height="100%">
            <table width="100%" border="0" cellspacing="0" cellpadding="0" height="100%">
                <tr>
                    <td class="left_bottom_border">&nbsp;</td>
                    <td class="left_bottom_border"><b>&nbsp;Y / N <br></b></td>
                    <td class="left_right_bottom_border"><b>&nbsp;Reason</b></td>
                </tr>
                <tr>
                    <td class="left_bottom_border"><b>&nbsp;Broadcast:&nbsp;</b></td>
                    <td class="left_bottom_border">&nbsp;<%=rsHeader.Fields("Broadcast_Suitable")%> </td>
                    <td class="left_right_bottom_border">&nbsp;<%=rsHeader.Fields("Broadcast_Suitable_Reason")%></td>
                </tr>
                <tr>
                    <td class="left_bottom_border"><b>&nbsp;DVD / Blu-Ray:&nbsp;</b></td>
                    <td class="left_bottom_border">&nbsp;<%=rsHeader.Fields("DVD_Blu_Ray_Suitable")%> </td>
                    <td class="left_right_bottom_border">&nbsp;<%=rsHeader.Fields("DVD_Blu_Ray_Suitable_Reason")%></td>
                </tr>
                <tr>
                    <td class="left_bottom_border"><b>&nbsp;VOD:&nbsp;</b></td>
                    <td class="left_bottom_border">&nbsp<%=rsHeader.Fields("VOD_Suitable")%></td>
                    <td class="left_right_bottom_border">&nbsp;<%=rsHeader.Fields("VOD_Suitable_Reason")%></td>
                </tr>
            </table>
        </td>
    </tr>
</table>

<table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>
 <% End If %>

<table width="100%" border="0" cellspacing="0" cellpadding="1" style="display:block;min-height:100px;">
    <tr>
        <td align="center" <%If rsHeader.Fields("Eval_Stat") <> "PASSED" Then%> colspan="5"<%End If%>>
	  <font class="txt_italic" size="2"><b>OVERALL COMMENTS</b></font>
    </td>
        <%If rsHeader.Fields("Eval_Stat") <> "PASSED" Then%>
        <td align="center" width="5">
            <font class="txt_italic" size="2">&nbsp;</font>
        </td>
        <td align="center" valign="top">
            <font class="txt_italic" size="2"><b>AUDIO COMMENTS / CORRECTIVE ACTIONS</b></font>
        </td>
        <td align="center" width="5">
            <font class="txt_italic" size="2">&nbsp;</font>
        </td>
        <td align="center" valign="top">
            <font class="txt_italic" size="2"><b>VIDEO COMMENTS / CORRECTIVE ACTIONS</b></font>
        </td>
        <%End If%>
    </tr>
    <tr>
        <td height="100%" <%If rsHeader.Fields("Eval_Stat") <> "PASSED" Then%> colspan="5"<%Else%> width="33%"<%End If%>>
		  <table  width="100%" height="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000">
			<tr>
			  <td  valign="top">&nbsp;<%=rsFullSpot.Fields("Comments")%>
			  <p>&nbsp;</p>
			  <p>&nbsp;</p>
			  </td>
			</tr>
		  </table>
	   </td>
        <%If rsHeader.Fields("Eval_Stat") <> "PASSED" Then%>
        <td align="center" width="5">
            <font class="txt_italic" size="2">&nbsp;</font>
        </td>
        <td width="33%" valign="top" height="100%">
            <table width="100%" height="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000">
                <tr>
                    <td valign="top">
                        &nbsp;<%=rsFullSpot.Fields("RecommendationComments")%>
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                    </td>
                </tr>
            </table>
        </td>
        <td align="center" width="5">
            <font class="txt_italic" size="2">&nbsp;</font>
        </td>
        <td width="33%" valign="top" height="100%">
            <table width="100%" height="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000">
                <tr>
                    <td valign="top">
                        &nbsp;<%=rsFullSpot.Fields("VideoComments")%>&nbsp;
                        <p>&nbsp;</p>
                        <p>&nbsp;</p>
                    </td>
                </tr>
            </table>
        </td>
        <%End If%>
    </tr>
</table>

<table width="100%" border="0" cellspacing="0" cellpadding="1">
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>

<%
j=0
thisPage = 2
rsBVMastLog.Open sqlBVIMastLog
if rsBVMastLog.BOF = true and rsBVMastLog.EOF =true then j=1
do while not rsBVMastLog.EOF or j=1
%>
<!-- ******************************************************* -->
<div class="PageBreak">
    <!-- Pages >= 2 -->
    <!-- ******************************************************* -->
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td width="180"><img src="../images/Logos/End-Cred-Red-Logo_tran-100x100.png" border="0"></td>
            <td align="center">
                <h2 class="txt_boldtype2">
                    QUALITY CONTROL REPORT FOR<br>
                    <%=rsHeader.Fields("CustName")%>
                </h2>
            </td>
            <td>
                Page:&nbsp;<%=thisPage%>&nbsp;of&nbsp;<span id="totalPage<%=thisPage%>"></span>
            </td>
        </tr>
        <tr>
            <td colspan="3" align="center"><b><%=rsHeader.Fields("Address")%></b>&nbsp;</td>
        </tr>
    </table>

    <table width="100%" border="0">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>


    <table width="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000" height="36">
        <tr>
            <td>
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td>Title:&nbsp; <b><%=rsHeader.Fields("Show")%></b></td>
                        <td>Part#:&nbsp;<b><%=rsHeader.Fields("This_part")%></b></td>
                        <td>QC#:&nbsp;<b><%=rsHeader.Fields("QCNum")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Episode:&nbsp; <b><%=rsHeader.Fields("Epis_name")%></b></td>
                        <td>Episode#:&nbsp;<b><%=rsHeader.Fields("Epis_no")%></b></b></td>
                        <td>WO#:&nbsp;<b><%=rsHeader.Fields("wonum")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <%

                        If Not IsNull(sAssetType) And sAssetType = "Tape"   Then
                        Response.Write "
                        <td>Subtitle:&nbsp; <b>" & rsHeader.Fields("Subtitle_QC") & "</b></td>"
                        End If
                        %>
                        <td>Language:&nbsp;<b><%=rsHeader.Fields("HLanguage")%></b></b></td>
                        <td>PO#:&nbsp; <b><%=rsHeader.Fields("Pono")%></b></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Version:&nbsp; <b><%=rsHeader.Fields("Version")%></b></td>
                        <td>TRT:&nbsp;<b><%=rsHeader.Fields("TRT")%></b></b></td>

                        <%
                        If Not IsNull(sAssetType) And sAssetType = "Tape"   Then
                        Response.Write "
                        <td>Tape #: <b>" & rsHeader.Fields("TapeNumber") & "</b></td>"
                        End If
                        %>

                    </tr>

                    <%
                    If Not IsNull(sAssetType) And sAssetType = "File"   Then
                    Response.Write "
                    <tr><td colspan='3'>&nbsp;</td></tr>"
                    Response.Write "
                    <tr><td colspan='3'>Filename: <b>" & rsHeader.Fields("Filename") & "</b></td></tr>"
                    End If
                    %>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Status:&nbsp; <font size=3><b><%=rsHeader.Fields("Eval_Stat")%></b></font></td>
                        <td>Head Logo:&nbsp;<b><%=rsHeader.Fields("HeadLogo")%></b></td>
                        <td>Tail Logo:&nbsp; <b><%=rsHeader.Fields("TailLogo")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Video Grade:&nbsp; <b><%=rsHeader.Fields("grdVideo")%></b></td>
                        <td>Audio Grade:&nbsp;<b><%=rsHeader.Fields("grdAudio")%></b></td>
                        <td>Overall Grade:&nbsp; <b><%=rsHeader.Fields("grdOverall")%></b></td>
                    </tr>

                </table>
            </td>
        </tr>

    </table>


    <table width="100%" border="0" cellspacing="0" cellpadding="1">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>

    <table width="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000">
        <tr>
            <td>

                <% If sAssetType = "Tape" Then %>
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td width="25%">Format:&nbsp; <b><%=rsHeader.Fields("Format")%></b></td>
                        <td width="25%">Standard:&nbsp; <b><%=rsHeader.Fields("Standard")%></b></td>
                        <td width="25%">Aspect Ratio:&nbsp; <b><%=rsHeader.Fields("Aspect")%></b></td>
                        <td width="25%">&nbsp; </td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Description:&nbsp; <b><%=rsHeader.Fields("TapeDesc1")%></b></td>
                        <td width="25%">&nbsp;</td>
                        <td width="25%">Time Code:&nbsp; <b><%=rsHeader.Fields("Time_Code")%></b></td>
                        <td width="25%">&nbsp;</td>
                    </tr>
                </table>
                <% Else %>
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td width="25%">Format:&nbsp; <b><%=rsHeader.Fields("Format")%></b></td>
                        <td width="25%">Standard:&nbsp; <b><%=rsHeader.Fields("Standard")%></b></td>
                        <td width="25%">Aspect Ratio:&nbsp; <b><%=rsHeader.Fields("Aspect")%></b></td>
                        <td width="25%">&nbsp; </td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Description:&nbsp; <b><%=rsHeader.Fields("TapeDesc1")%></b></td>
                        <td width="25%">&nbsp;</td>
                        <td width="25%">Time Code:&nbsp; <b><%=rsHeader.Fields("Time_Code")%></b></td>
                        <td width="25%">Frame Size:&nbsp; <b><%=rsHeader.Fields("Frame_Size")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Video Codec:&nbsp; <b><%=rsHeader.Fields("Video_Codec")%></b></td>
                        <td width="25%">Video Bit Rate:&nbsp;<b><%=rsHeader.Fields("Video_Bit_Rate")%> </td>
                        <td width="25%">Video Bit Depth:&nbsp; <b><%=rsHeader.Fields("Video_Bit_Depth")%></b></td>
                        <td width="25%">Bit Rate Mode:&nbsp; <b><%=rsHeader.Fields("Bit_Rate_Mode")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Audio Codec:&nbsp; <b><%=rsHeader.Fields("Audio_Codec")%></b></td>
                        <td width="25%">Audio Bit Rate:&nbsp;<b><%=rsHeader.Fields("Audio_Bit_Rate")%> </td>
                        <td width="25%">Audio Bit Depth:&nbsp; <b><%=rsHeader.Fields("Audio_Bit_Depth")%></b></td>
                        <td width="25%">Sample Rate:&nbsp; <b><%=rsHeader.Fields("Sample_Rate")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">GOP Structure:&nbsp; <b><%=rsHeader.Fields("GOP_Structure")%></b></td>
                        <td width="25%">Gamut:&nbsp;<b><%=rsHeader.Fields("Gamut")%> </td>
                        <td width="25%">Colour Encoding:&nbsp; <b><%=rsHeader.Fields("Colour_Encoding")%></b></td>
                        <td width="25%">File Size:&nbsp; <b><%=rsHeader.Fields("File_Size")%></b></td>
                    </tr>

                </table>
                <% End IF %>
            </td>
        </tr>
    </table>

    <table width="100%" border="0" cellspacing="0" cellpadding="1">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td>
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td width="12%" align="center" class="left_top_border"><b>Time Code</b></td>
                        <td width="5%" align="center" class="left_top_border"><b>Type</b></td>
                        <td width="54%" align="center" class="left_top_border"><b>Fault Description</b></td>
                        <td width="5%" align="center" class="left_top_border"><b>GRD</b></td>
                        <td width="7%" align="center" class="left_top_border"><b>Sector</b></td>
                        <td width="9%" align="center" class="left_top_border"><b>Same As Master</b></td>
                        <td width="8%" align="center" class="left_right_top_border"><b>Item Duration</b></td>
                    </tr>
                    <% nTotalLines = 0
                    do while nTotalLines < 420
                    nLines = 0
                    if rsBVMastLog.EOF = false then
                    nLines = GetLines(rsBVMastLog.Fields("Note"))
                    nTotalLines = nTotalLines + nLines
                    else
                    nTotalLines = nTotalLines + 13
                    end if

                    if nTotalLines > 420 Then
                    exit do

                    else

                    %>
                    <tr>
                        <td width="12%" align="center" class="left_top_border"><%if rsBVMastLog.EOF = false then Response.write(rsBVMastLog.Fields("Time_Code"))%>&nbsp;</td>
                        <td width="5%" align="center" class="left_top_border"><%if rsBVMastLog.EOF = false then Response.write(rsBVMastLog.Fields("QC_Code"))%>&nbsp;</td>
                        <td width="54%" align="left" class="left_top_border"><%if rsBVMastLog.EOF = false then Response.write(rsBVMastLog.Fields("Note"))%>&nbsp;</td>
                        <td width="5%" align="center" class="left_top_border"><%if rsBVMastLog.EOF = false then Response.write(rsBVMastLog.Fields("QC_Grade"))%>&nbsp;</td>
                        <td width="7%" align="center" class="left_top_border"><%if rsBVMastLog.EOF = false then Response.write(rsBVMastLog.Fields("Action"))%>&nbsp;</td>
                        <td width="9%" align="center" class="left_top_border">
                            <%if rsBVMastLog.EOF = false then
                            if rsBVMastLog.Fields("in_master") = -1 then
                            Response.write("Yes")
                            else
                            Response.Write("")
                            end if
                            end if%>&nbsp;
                        </td>
                        <td width="8%" align="center" class="left_right_top_border"><%if rsBVMastLog.EOF = false then Response.write(rsBVMastLog.Fields("item_duratn"))%>&nbsp;</td>
                    </tr>
                    <%	end if
                    if rsBVMastLog.EOF = false then rsBVMastLog.MoveNext
                    loop%>
                    <tr>
                        <td colspan=7 class="top_border">&nbsp;</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td colspan=5>&nbsp;</td>
        </tr>
        <tr>
            <td>Type:</td>
            <td>F=Film</td>
            <td>V=Video</td>
            <td>A=Audio</td>
            <td colspan=2 align="center">
                <table cellspacing=0 border=1 bordercolor="#000000" width=90 id="tblTapeFormat">
                    <tr>
                        <td width=30 align="center" valign="middle">U-L</td>
                        <td width=30 align="center" valign="middle">U-C</td>
                        <td width=30 align="center" valign="middle">U-R</td>
                    </tr>
                    <tr>
                        <td width=30 align="center" valign="middle">M-L</td>
                        <td width=30 align="center" valign="middle">M-C</td>
                        <td width=30 align="center" valign="middle">M-R</td>
                    </tr>
                    <tr>
                        <td width=30 align="center" valign="middle">L-L</td>
                        <td width=30 align="center" valign="middle">L-C</td>
                        <td width=30 align="center" valign="middle">L-R</td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td colspan=5>&nbsp;</td>
        </tr>
        <%if rsHeader.Fields("GradingScale") = 3 then %>
        <tr>
            <td>Severity Grades:</td>
            <td>1=Acceptable</td>
            <td>2=Marginal</td>
            <td>3=Unacceptable</td>
            <td colspan=2>&nbsp;</td>
        </tr>
        <%end if%>
        <%if rsHeader.Fields("GradingScale") = 4 then %>
        <tr>
            <td>Severity Grades:</td>
            <td>1=Standard/Non Detectable</td>
            <td>2=Acceptable</td>
            <td>3=Marginal/Intrusive</td>
            <td>4=Unacceptable</td>
            <td>&nbsp;</td>
        </tr>
        <%end if%>
        <%if rsHeader.Fields("GradingScale") = 5 then %>
        <tr>
            <td>Severity Grades:</td>
            <td>1=Very Annoying</td>
            <td>2=Annoying</td>
            <td>3=Slightly Annoying</td>
            <td>4=Perceptible but not Annoying</td>
            <td>5=Imperceptible</td>
        </tr>
        <%end if%>
    </table>
</div>
<% j=0

	Response.Write("
<script>
")
	for i = 1 to thisPage
	Response.Write("totalPage" & i & ".innerText = '" & thisPage & "';")
	next
	Response.Write("</script>")

	thisPage = thisPage + 1
	loop
	rsBVMastLog.Close
	set rsBVMastLog = Nothing
%>



<%
j=0
'thisPage = thisPage + 1
if rsTextInfo.BOF = true and rsTextInfo.EOF =true then j=1
do while not rsTextInfo.EOF or j=1
%>
<!-- ******************************************************* -->
<div class="PageBreak">
    <!-- Pages > Log Pages -->
    <!-- ******************************************************* -->
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td width="180"><img src="../images/Logos/End-Cred-Red-Logo_tran-100x100.png" border="0"></td>
            <td align="center">
                <h2 class="txt_boldtype2">
                    QUALITY CONTROL REPORT FOR<br>
                    <%=rsHeader.Fields("CustName")%>
                </h2>
            </td>
            <td>
                Page:&nbsp;<%=thisPage%>&nbsp;of&nbsp;<span id="totalPage<%=thisPage%>"></span>
            </td>
        </tr>
        <tr>
            <td colspan="3" align="center"><b><%=rsHeader.Fields("Address")%></b>&nbsp;</td>
        </tr>
    </table>
    <table width="100%" border="0">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>


    <table width="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000" height="36">
        <tr>
            <td>
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td>Title:&nbsp; <b><%=rsHeader.Fields("Show")%></b></td>
                        <td>Part#:&nbsp;<b><%=rsHeader.Fields("This_part")%></b></td>
                        <td>QC#:&nbsp;<b><%=rsHeader.Fields("QCNum")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="3">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Episode:&nbsp; <b><%=rsHeader.Fields("Epis_name")%></b></td>
                        <td>Episode#:&nbsp;<b><%=rsHeader.Fields("Epis_no")%></b></b></td>
                        <td>WO#:&nbsp;<b><%=rsHeader.Fields("wonum")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="3">&nbsp;</td>
                    </tr>
                    <tr>
                        <%

                        If Not IsNull(sAssetType) And sAssetType = "Tape"   Then
                        Response.Write "
                        <td>Subtitle:&nbsp; <b>" & rsHeader.Fields("Subtitle_QC") & "</b></td>"
                        End If
                        %>
                        <td>Language:&nbsp;<b><%=rsHeader.Fields("HLanguage")%></b></b></td>
                        <td>PO#:&nbsp; <b><%=rsHeader.Fields("Pono")%></b></b></td>
                    </tr>
                    <tr>
                        <td colspan="3">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Version:&nbsp; <b><%=rsHeader.Fields("Version")%></b></td>
                        <td>TRT:&nbsp;<b><%=rsHeader.Fields("TRT")%></b></b></td>

                        <%
                        If Not IsNull(sAssetType) And sAssetType = "Tape"   Then
                        Response.Write "
                        <td>Tape #: <b>" & rsHeader.Fields("TapeNumber") & "</b></td>"
                        End If
                        %>

                    </tr>

                    <%
                    If Not IsNull(sAssetType) And sAssetType = "File"   Then
                    Response.Write "
                    <tr><td colspan='3'>&nbsp;</td></tr>"
                    Response.Write "
                    <tr><td colspan='3'>Filename: <b>" & rsHeader.Fields("Filename") & "</b></td></tr>"
                    End If
                    %>

                    <tr>
                        <td colspan="3">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Status:&nbsp; <font size=3><b><%=rsHeader.Fields("Eval_Stat")%></b></font></td>
                        <td>Head Logo:&nbsp;<b><%=rsHeader.Fields("HeadLogo")%></b></td>
                        <td>Tail Logo:&nbsp; <b><%=rsHeader.Fields("TailLogo")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="3">&nbsp;</td>
                    </tr>
                    <tr>
                        <td>Video Grade:&nbsp; <b><%=rsHeader.Fields("grdVideo")%></b></td>
                        <td>Audio Grade:&nbsp;<b><%=rsHeader.Fields("grdAudio")%></b></td>
                        <td>Overall Grade:&nbsp; <b><%=rsHeader.Fields("grdOverall")%></b></td>
                    </tr>

                </table>
            </td>
        </tr>

    </table>


    <table width="100%" border="0" cellspacing="0" cellpadding="1">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>

    <table width="100%" border="1" cellspacing="0" cellpadding="1" bordercolor="#000000">
        <tr>
            <td>
                <% If sAssetType = "Tape" Then %>
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td width="25%">Format:&nbsp; <b><%=rsHeader.Fields("Format")%></b></td>
                        <td width="25%">Standard:&nbsp; <b><%=rsHeader.Fields("Standard")%></b></td>
                        <td width="25%">Aspect Ratio:&nbsp; <b><%=rsHeader.Fields("Aspect")%></b></td>
                        <td width="25%">&nbsp; </td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Description:&nbsp; <b><%=rsHeader.Fields("TapeDesc1")%></b></td>
                        <td width="25%">&nbsp;</td>
                        <td width="25%">Time Code:&nbsp; <b><%=rsHeader.Fields("Time_Code")%></b></td>
                        <td width="25%">&nbsp;</td>
                    </tr>
                </table>
                <% Else %>
                <table width="100%" border="0" cellspacing="0" cellpadding="1">
                    <tr>
                        <td width="25%">Format:&nbsp; <b><%=rsHeader.Fields("Format")%></b></td>
                        <td width="25%">Standard:&nbsp; <b><%=rsHeader.Fields("Standard")%></b></td>
                        <td width="25%">Aspect Ratio:&nbsp; <b><%=rsHeader.Fields("Aspect")%></b></td>
                        <td width="25%">&nbsp; </td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Description:&nbsp; <b><%=rsHeader.Fields("TapeDesc1")%></b></td>
                        <td width="25%">&nbsp;</td>
                        <td width="25%">Time Code:&nbsp; <b><%=rsHeader.Fields("Time_Code")%></b></td>
                        <td width="25%">Frame Size:&nbsp; <b><%=rsHeader.Fields("Frame_Size")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Video Codec:&nbsp; <b><%=rsHeader.Fields("Video_Codec")%></b></td>
                        <td width="25%">Video Bit Rate:&nbsp;<b><%=rsHeader.Fields("Video_Bit_Rate")%> </td>
                        <td width="25%">Video Bit Depth:&nbsp; <b><%=rsHeader.Fields("Video_Bit_Depth")%></b></td>
                        <td width="25%">Bit Rate Mode:&nbsp; <b><%=rsHeader.Fields("Bit_Rate_Mode")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">Audio Codec:&nbsp; <b><%=rsHeader.Fields("Audio_Codec")%></b></td>
                        <td width="25%">Audio Bit Rate:&nbsp;<b><%=rsHeader.Fields("Audio_Bit_Rate")%> </td>
                        <td width="25%">Audio Bit Depth:&nbsp; <b><%=rsHeader.Fields("Audio_Bit_Depth")%></b></td>
                        <td width="25%">Sample Rate:&nbsp; <b><%=rsHeader.Fields("Sample_Rate")%></b></td>
                    </tr>
                    <tr>
                        <td colspan="4">&nbsp;</td>
                    </tr>
                    <tr>
                        <td width="25%">GOP Structure:&nbsp; <b><%=rsHeader.Fields("GOP_Structure")%></b></td>
                        <td width="25%">Gamut:&nbsp;<b><%=rsHeader.Fields("Gamut")%> </td>
                        <td width="25%">Colour Encoding:&nbsp; <b><%=rsHeader.Fields("Colour_Encoding")%></b></td>
                        <td width="25%">File Size:&nbsp; <b><%=rsHeader.Fields("File_Size")%></b></td>
                    </tr>

                </table>
                <% End If %>
            </td>
        </tr>
    </table>

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td>&nbsp;</td>
        </tr>
    </table>
    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td>
                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr height=30>
                        <td width="64%" align="center" class="left_top_border"><b>Text</b></td>
                        <td width="13%" align="center" class="left_top_border"><b>Time Code In</b></td>
                        <td width="13%" align="center" class="left_right_top_border"><b>Time Code Out</b></td>

                    </tr>
                    <% nTotalLines = 0
                    do while nTotalLines < 520
                    nLines = 0
                    if rsTextInfo.EOF = false then
                    nLines = GetLines(rsTextInfo.Fields("TextInfo"))
                    nTotalLines = nTotalLines + nLines
                    else
                    nTotalLines = nTotalLines + 13
                    end if

                    if nTotalLines > 520 Then
                    exit do

                    else

                    %>
                    <tr>
                        <td width="4%" align="center" class="left_top_border"><%if rsTextInfo.EOF = false then Response.Write(rsTextInfo.Fields("TextInfo"))%>&nbsp</td>
                        <td width="11%" align="center" class="left_top_border"><%if rsTextInfo.EOF = false then Response.write(rsTextInfo.Fields("TimecodeIn"))%>&nbsp;</td>
                        <td width="5%" align="center" class="left_right_top_border"><%if rsTextInfo.EOF = false then Response.write(rsTextInfo.Fields("TimecodeOut"))%>&nbsp;</td>
                    </tr>
                    <%	end if
                    if rsTextInfo.EOF = false then rsTextInfo.MoveNext
                    loop%>
                    <tr>
                        <td colspan=3 class="top_border">&nbsp;</td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>*@
